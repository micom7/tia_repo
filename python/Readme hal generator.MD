# HAL Code Generator –¥–ª—è TIA Portal (Excel Edition)

–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è SCL –∫–æ–¥—É –¥–ª—è HAL —à–∞—Ä—É –∑ Excel/CSV –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó.

## üìã –ú–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

- ‚úÖ –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ .xlsx, .xls, .csv —Ñ–æ—Ä–º–∞—Ç—ñ–≤
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è Read/Write —Ñ—É–Ω–∫—Ü—ñ–π
- ‚úÖ –Ü–Ω–≤–µ—Ä—Å—ñ—è –≤—Ö–æ–¥—ñ–≤/–≤–∏—Ö–æ–¥—ñ–≤
- ‚úÖ SafeMode –¥–ª—è –≤–∏—Ö–æ–¥—ñ–≤
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
- ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤ –∞–¥—Ä–µ—Å

## üõ†Ô∏è –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

### –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ

```bash
# –î–ª—è .xlsx —Ñ–∞–π–ª—ñ–≤ (Office 2007+)
pip install openpyxl

# –î–ª—è .xls —Ñ–∞–π–ª—ñ–≤ (Office 97-2003)
pip install xlrd

# –û–ø—Ü—ñ–π–Ω–æ: –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó –º—ñ–∂ —Ñ–æ—Ä–º–∞—Ç–∞–º–∏
pip install pandas openpyxl xlrd
```

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è .xls ‚Üí .xlsx

–Ø–∫—â–æ –Ω–µ –º–æ–∂–µ—Ç–µ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ xlrd, –∫–æ–Ω–≤–µ—Ä—Ç—É–π—Ç–µ —Ñ–∞–π–ª:

**–°–ø–æ—Å—ñ–± 1: Microsoft Excel**
1. –í—ñ–¥–∫—Ä–∏—Ç–∏ IO_Config.xls
2. –§–∞–π–ª ‚Üí –ó–±–µ—Ä–µ–≥—Ç–∏ —è–∫ ‚Üí –§–æ—Ä–º–∞—Ç: Excel Workbook (.xlsx)

**–°–ø–æ—Å—ñ–± 2: LibreOffice Calc**
1. –í—ñ–¥–∫—Ä–∏—Ç–∏ IO_Config.xls
2. –§–∞–π–ª ‚Üí –ó–±–µ—Ä–µ–≥—Ç–∏ —è–∫ ‚Üí –§–æ—Ä–º–∞—Ç: Microsoft Excel 2007-365 (.xlsx)

**–°–ø–æ—Å—ñ–± 3: Python (—è–∫—â–æ —î pandas)**
```python
import pandas as pd
df = pd.read_excel('IO_Config.xls')
df.to_excel('IO_Config.xlsx', index=False)
```

**–°–ø–æ—Å—ñ–± 4: –û–Ω–ª–∞–π–Ω –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä**
- https://convertio.co/xls-xlsx/
- https://www.zamzar.com/convert/xls-to-xlsx/

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Excel —Ñ–∞–π–ª—É

### –û–±–æ–≤'—è–∑–∫–æ–≤—ñ –∫–æ–ª–æ–Ω–∫–∏:

| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–ø–∏—Å | –ü—Ä–∏–∫–ª–∞–¥ |
|---------|-----|------|---------|
| `Slot` | –ß–∏—Å–ª–æ | –ù–æ–º–µ—Ä —Å–ª–æ—Ç—É (0..255) | 0 |
| `DeviceType` | –ß–∏—Å–ª–æ | –¢–∏–ø –ø—Ä–∏—Å—Ç—Ä–æ—é (2=Redler) | 2 |
| `TypedIndex` | –ß–∏—Å–ª–æ | –Ü–Ω–¥–µ–∫—Å —É Redler[] (0,1,2...) | 0 |
| `Name` | –¢–µ–∫—Å—Ç | –ù–∞–∑–≤–∞ –º–µ—Ö–∞–Ω—ñ–∑–º—É | Redler_Intake_1 |
| `DI_Speed_Addr` | –¢–µ–∫—Å—Ç | –ê–¥—Ä–µ—Å–∞ –≤—Ö–æ–¥—É —à–≤–∏–¥–∫–æ—Å—Ç—ñ | %I0.0 |
| `DI_Breaker_Addr` | –¢–µ–∫—Å—Ç | –ê–¥—Ä–µ—Å–∞ –≤—Ö–æ–¥—É –∞–≤—Ç–æ–º–∞—Ç–∞ | %I0.1 |
| `DI_Overflow_Addr` | –¢–µ–∫—Å—Ç | –ê–¥—Ä–µ—Å–∞ –≤—Ö–æ–¥—É –ø–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è | %I0.2 |
| `DO_Run_Addr` | –¢–µ–∫—Å—Ç | –ê–¥—Ä–µ—Å–∞ –≤–∏—Ö–æ–¥—É RUN | %Q0.0 |
| `DI_Speed_Invert` | Boolean | –Ü–Ω–≤–µ—Ä—Ç—É–≤–∞—Ç–∏ Speed | FALSE |
| `DI_Breaker_Invert` | Boolean | –Ü–Ω–≤–µ—Ä—Ç—É–≤–∞—Ç–∏ Breaker | FALSE |
| `DI_Overflow_Invert` | Boolean | –Ü–Ω–≤–µ—Ä—Ç—É–≤–∞—Ç–∏ Overflow | FALSE |
| `DO_Run_Invert` | Boolean | –Ü–Ω–≤–µ—Ä—Ç—É–≤–∞—Ç–∏ Run | FALSE |
| `Enable_OK` | Boolean | –ê–∫—Ç–∏–≤–Ω–∏–π –º–µ—Ö–∞–Ω—ñ–∑–º | TRUE |

### –û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ –∫–æ–ª–æ–Ω–∫–∏:

| –ö–æ–ª–æ–Ω–∫–∞ | –û–ø–∏—Å | –ü—Ä–∏–∫–ª–∞–¥ |
|---------|------|---------|
| `Comment` | –ö–æ–º–µ–Ω—Ç–∞—Ä/–æ–ø–∏—Å | –ü—Ä–∏–π–æ–º –∑–µ—Ä–Ω–∞ –∑ –∞–≤—Ç–æ—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç—É |
| `Location` | –†–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è | –ë–∞—à—Ç–∞ –ë2, –ø–æ–≤–µ—Ä—Ö 3 |
| `Description` | –î–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å | –†–µ–¥–ª–µ—Ä –¥–æ–≤–∂–∏–Ω–æ—é 15–º, 22–∫–í—Ç |

## üöÄ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –ë–∞–∑–æ–≤–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

```bash
# –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –∑ Excel
python generate_hal_excel.py IO_Config.xlsx

# –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –∑ CSV
python generate_hal_excel.py IO_Config.csv

# –í–∫–∞–∑–∞—Ç–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é –≤–∏–≤–æ–¥—É
python generate_hal_excel.py IO_Config.xlsx -o ./generated

# –î–µ—Ç–∞–ª—å–Ω–∏–π –≤–∏–≤—ñ–¥ (–¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏)
python generate_hal_excel.py IO_Config.xlsx -v
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–æ–±–æ—Ç–∏

–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å—Ç–≤–æ—Ä—é—î 4 —Ñ–∞–π–ª–∏:

1. **FC_HAL_Read_Redler_Static.scl** - —Ñ—É–Ω–∫—Ü—ñ—è —á–∏—Ç–∞–Ω–Ω—è –≤—Ö–æ–¥—ñ–≤
2. **FC_HAL_Write_Redler_Static.scl** - —Ñ—É–Ω–∫—Ü—ñ—è –∑–∞–ø–∏—Å—É –≤–∏—Ö–æ–¥—ñ–≤
3. **DB_IO_Config_Doc.scl** - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
4. **HAL_IO_Mapping.md** - —Ç–∞–±–ª–∏—Ü—è –º–∞–ø—ñ–Ω–≥—É —É Markdown

## üìù –ü—Ä–∏–∫–ª–∞–¥ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó

### IO_Config.xlsx (–º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥)

| Slot | DeviceType | TypedIndex | Name | DI_Speed_Addr | DI_Breaker_Addr | DI_Overflow_Addr | DO_Run_Addr | DI_Speed_Invert | DI_Breaker_Invert | DI_Overflow_Invert | DO_Run_Invert | Enable_OK | Comment |
|------|------------|------------|------|---------------|-----------------|------------------|-------------|-----------------|-------------------|-------------------|---------------|-----------|---------|
| 0 | 2 | 0 | Redler_1 | %I0.0 | %I0.1 | %I0.2 | %Q0.0 | FALSE | FALSE | FALSE | FALSE | TRUE | –ü—Ä–∏–π–æ–º |
| 1 | 2 | 1 | Redler_2 | %I0.3 | %I0.4 | %I0.5 | %Q0.1 | FALSE | TRUE | FALSE | FALSE | TRUE | –í–µ–∂–∞ –ë2 |
| 2 | 2 | 2 | Redler_3 | %I0.6 | %I0.7 | %I1.0 | %Q0.2 | TRUE | FALSE | FALSE | FALSE | TRUE | –°–∏–ª–æ—Å 10 |

## ‚öôÔ∏è –í–∞–ª—ñ–¥–∞—Ü—ñ—è

–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—î:

‚úÖ –ù–∞—è–≤–Ω—ñ—Å—Ç—å –æ–±–æ–≤'—è–∑–∫–æ–≤–∏—Ö –∫–æ–ª–æ–Ω–æ–∫  
‚úÖ –î—É–±–ª—ñ–∫–∞—Ç–∏ Slot  
‚úÖ –î—É–±–ª—ñ–∫–∞—Ç–∏ TypedIndex  
‚úÖ –î—É–±–ª—ñ–∫–∞—Ç–∏ –∞–¥—Ä–µ—Å –≤—Ö–æ–¥—ñ–≤/–≤–∏—Ö–æ–¥—ñ–≤  
‚úÖ –§–æ—Ä–º–∞—Ç –∞–¥—Ä–µ—Å (%I –¥–ª—è –≤—Ö–æ–¥—ñ–≤, %Q –¥–ª—è –≤–∏—Ö–æ–¥—ñ–≤)  
‚úÖ –ü–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å TypedIndex (–±–µ–∑ –ø—Ä–æ–ø—É—Å–∫—ñ–≤: 0,1,2...)  

## üì§ –Ü–º–ø–æ—Ä—Ç —É TIA Portal

1. –í—ñ–¥–∫—Ä–∏—Ç–∏ –ø—Ä–æ–µ–∫—Ç —É TIA Portal
2. Project tree ‚Üí External source files ‚Üí Import
3. –í–∏–±—Ä–∞—Ç–∏ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω—ñ .scl —Ñ–∞–π–ª–∏:
   - FC_HAL_Read_Redler_Static.scl
   - FC_HAL_Write_Redler_Static.scl
   - DB_IO_Config_Doc.scl
4. Compile

## üîÑ Workflow

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  IO_Config.xlsx    ‚îÇ  ‚Üê –†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ
          ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ generate_hal_excel ‚îÇ  ‚Üê –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä
‚îÇ       .py          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ
          ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  3 x .scl —Ñ–∞–π–ª–∏    ‚îÇ  ‚Üê –Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ —É TIA Portal
‚îÇ  1 x .md —Ñ–∞–π–ª      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üêõ –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–æ–º–∏–ª–æ–∫

### –ü–æ–º–∏–ª–∫–∞: "–§–∞–π–ª –ø–æ—Ä–æ–∂–Ω—ñ–π"
**–ü—Ä–∏—á–∏–Ω–∞:** Excel —Ñ–∞–π–ª –Ω–µ –º—ñ—Å—Ç–∏—Ç—å –¥–∞–Ω–∏—Ö  
**–†—ñ—à–µ–Ω–Ω—è:** –î–æ–¥–∞–π—Ç–µ —Ö–æ—á–∞ –± –æ–¥–∏–Ω —Ä—è–¥–æ–∫ –∑ –¥–∞–Ω–∏–º–∏

### –ü–æ–º–∏–ª–∫–∞: "–í—ñ–¥—Å—É—Ç–Ω—ñ –æ–±–æ–≤'—è–∑–∫–æ–≤—ñ –∫–æ–ª–æ–Ω–∫–∏"
**–ü—Ä–∏—á–∏–Ω–∞:** –£ —Ñ–∞–π–ª—ñ –Ω–µ–º–∞—î –ø–æ—Ç—Ä—ñ–±–Ω–∏—Ö –∫–æ–ª–æ–Ω–æ–∫  
**–†—ñ—à–µ–Ω–Ω—è:** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞–∑–≤–∏ –∫–æ–ª–æ–Ω–æ–∫ (case-sensitive!)

### –ü–æ–º–∏–ª–∫–∞: "–î—É–±–ª—ñ–∫–∞—Ç –≤—Ö–æ–¥—É %I0.0"
**–ü—Ä–∏—á–∏–Ω–∞:** –û–¥–Ω–∞ –∞–¥—Ä–µ—Å–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∞ –¥–≤—ñ—á—ñ  
**–†—ñ—à–µ–Ω–Ω—è:** –ó–º—ñ–Ω—ñ—Ç—å –∞–¥—Ä–µ—Å—É –Ω–∞ —É–Ω—ñ–∫–∞–ª—å–Ω—É

### –ü–æ–º–∏–ª–∫–∞: "–ü—Ä–æ–ø—É—Å–∫ —É TypedIndex"
**–ü—Ä–∏—á–∏–Ω–∞:** TypedIndex –º–∞—î –±—É—Ç–∏ 0,1,2,3... –±–µ–∑ –ø—Ä–æ–ø—É—Å–∫—ñ–≤  
**–†—ñ—à–µ–Ω–Ω—è:** –ü–µ—Ä–µ–Ω—É–º–µ—Ä—É–π—Ç–µ TypedIndex –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ

### –ü–æ–º–∏–ª–∫–∞: "openpyxl does not support the old .xls"
**–ü—Ä–∏—á–∏–Ω–∞:** –§–∞–π–ª —É —Å—Ç–∞—Ä–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ .xls  
**–†—ñ—à–µ–Ω–Ω—è:** –ö–æ–Ω–≤–µ—Ä—Ç—É–π—Ç–µ —É .xlsx (–¥–∏–≤–∏—Å—å —Ä–æ–∑–¥—ñ–ª "–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è")

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ä–µ—Å—É—Ä—Å—ñ–≤

–î–ª—è 200 –º–µ—Ö–∞–Ω—ñ–∑–º—ñ–≤ (600 –≤—Ö–æ–¥—ñ–≤, 200 –≤–∏—Ö–æ–¥—ñ–≤):

- **–ß–∞—Å HAL Read:** ~0.5 –º—Å
- **–ß–∞—Å HAL Write:** ~0.2 –º—Å
- **–ó–∞–≥–∞–ª—å–Ω–∏–π —á–∞—Å HAL:** ~0.7 –º—Å (7% –≤—ñ–¥ —Ü–∏–∫–ª—É 10 –º—Å)
- **–ü–∞–º'—è—Ç—å:** ~1 KB stack + 22 KB data

## üí° –ü–æ—Ä–∞–¥–∏

1. **–ó–∞–ø–æ–≤–Ω—é–π—Ç–µ Comment** - —Ü–µ –¥–æ–ø–æ–º–∞–≥–∞—î –ø—Ä–∏ –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—ñ
2. **–ì—Ä—É–ø—É–π—Ç–µ –º–µ—Ö–∞–Ω—ñ–∑–º–∏ –ª–æ–≥—ñ—á–Ω–æ** - –ø–æ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—á–Ω–∏—Ö –ª—ñ–Ω—ñ—è—Ö
3. **–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∑—Ä–æ–∑—É–º—ñ–ª—ñ Name** - Redler_Tower_B2_Floor3
4. **–ü–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ —Ñ–∞–π–ª –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—î—é** - –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –µ–∫–æ–Ω–æ–º–∏—Ç—å —á–∞—Å
5. **–ó–±–µ—Ä—ñ–≥–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—ñ –∫–æ–ø—ñ—ó** - IO_Config_v1.xlsx, v2.xlsx...

## üÜò –ü—ñ–¥—Ç—Ä–∏–º–∫–∞

–Ø–∫—â–æ –≤–∏–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º–∏:

1. –ó–∞–ø—É—Å—Ç—ñ—Ç—å –∑ –ø—Ä–∞–ø–æ—Ä–æ–º `-v` –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –≤–∏–≤–æ–¥—É
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ñ–æ—Ä–º–∞—Ç Excel —Ñ–∞–π–ª—É
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –≤—Å—ñ—Ö –æ–±–æ–≤'—è–∑–∫–æ–≤–∏—Ö –∫–æ–ª–æ–Ω–æ–∫
4. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ñ–æ—Ä–º–∞—Ç –∞–¥—Ä–µ—Å (%I... –¥–ª—è –≤—Ö–æ–¥—ñ–≤, %Q... –¥–ª—è –≤–∏—Ö–æ–¥—ñ–≤)

## üìú –õ—ñ—Ü–µ–Ω–∑—ñ—è

Elevator Automation Team ¬© 2026